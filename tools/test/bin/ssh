#!/usr/bin/env bash
IFS='@' read -r user fqdn <<<"$1"
IFS='.' read -r host _ <<<"$fqdn"

case "$user" in
locksmith)
	export LUKS_DEVICE="/dev/null"
	export KEY_FILE=$BATS_TEST_TMPDIR/host-$fqdn/keys/host-$host
	shift
	"$TESTROOT/remote/locksmith.sh" "$@"
	;;
*)
	echo "invalid user '$user'" >&2
	exit 1
	;;
esac
